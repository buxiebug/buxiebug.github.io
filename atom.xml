<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>码农想种地</title>
  <subtitle>努力的Coder</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://trytofix.com/"/>
  <updated>2016-04-12T11:01:41.174Z</updated>
  <id>http://trytofix.com/</id>
  
  <author>
    <name>brian.yang</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>test docker</title>
    <link href="http://trytofix.com/2016/04/12/test-docker/"/>
    <id>http://trytofix.com/2016/04/12/test-docker/</id>
    <published>2016-04-12T10:28:07.000Z</published>
    <updated>2016-04-12T11:01:41.174Z</updated>
    
    <content type="html"></content>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Fabric简化Python发布流程</title>
    <link href="http://trytofix.com/2016/04/11/Fabric%E7%AE%80%E5%8C%96Python%E5%8F%91%E5%B8%83%E6%B5%81%E7%A8%8B/"/>
    <id>http://trytofix.com/2016/04/11/Fabric简化Python发布流程/</id>
    <published>2016-04-11T11:57:56.000Z</published>
    <updated>2016-04-12T11:01:41.166Z</updated>
    
    <content type="html">&lt;p&gt;Python通用发布流程：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;git checkout - b workspace&lt;/li&gt;&lt;li&gt;编写逻辑&lt;/li&gt;&lt;li&gt;git add &amp;amp;&amp;amp; git commit &amp;amp;&amp;amp; git push&lt;/li&gt;&lt;li&gt;ssh登陆服务器&lt;/li&gt;&lt;li&gt;git pull&lt;/li&gt;&lt;li&gt;启动脚本&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;在每次修改代码之后，都需要执行git提交，登陆服务器，更新代码，启动代码．登陆服务器，更新代码是一项重复枯燥无味的工作．&lt;/p&gt;&lt;p&gt;python使用Fabric可以轻松的在本地用Pythonic的方式完成ssh连接和执行shell命令．快速入门&lt;/p&gt;&lt;p&gt;安装方法：&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo pip install fabric&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;以web开发为例，将更新的web代码提交到git,在服务器端通过git更新代码，并重启uwsgi服务器，fabric代码如下：&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#fabfile.py&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;__author__ = &lt;span class=&quot;string&quot;&gt;&#39;brianyang&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; fabric.api &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; local, settings, abort, cd, run, env, lcd, task&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; fabric.contrib.console &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; confirm&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; fabric.network &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; ssh&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ssh.util.log_to_file(&lt;span class=&quot;string&quot;&gt;&quot;paramiko.log&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env.hosts = [&lt;span class=&quot;string&quot;&gt;&#39;127.0.0.1&#39;&lt;/span&gt;]　　　&lt;span class=&quot;comment&quot;&gt;#服务器地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env.user = &lt;span class=&quot;string&quot;&gt;&#39;root&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env.key_filename = &lt;span class=&quot;string&quot;&gt;&quot;~/Documents/why.pem&quot;&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;#ssh私钥文件地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#本地提交代码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;commit_code&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    code_dir = &lt;span class=&quot;string&quot;&gt;&quot;/home/q/blog&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; settings(warn_only=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; lcd(code_dir):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            result = local(&lt;span class=&quot;string&quot;&gt;&quot;git pull origin master&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; result.failed &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; confirm(&lt;span class=&quot;string&quot;&gt;&quot;Pull failed, continue?&quot;&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                abort(&lt;span class=&quot;string&quot;&gt;&quot;abort!&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            local(&lt;span class=&quot;string&quot;&gt;&quot;git add .&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            local(&lt;span class=&quot;string&quot;&gt;&quot;git commit -m &#39;auto commit&#39;&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            local(&lt;span class=&quot;string&quot;&gt;&quot;git push origin master&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#服务器发布代码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;deploy_server&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    code_dir = &lt;span class=&quot;string&quot;&gt;&quot;/home/q/blog&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; settings(warn_only=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; cd(code_dir):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            run(&lt;span class=&quot;string&quot;&gt;&quot;sudo git pull origin master&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            result = run(&lt;span class=&quot;string&quot;&gt;&quot;sudo uwsgi --ini conf/uwsgi.conf  --reload pidfile&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; result.failed:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                run(&lt;span class=&quot;string&quot;&gt;&quot;sudo ps -ef|grep uwsgi&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                run(＂＂＂sudo ps -ef|grep &lt;span class=&quot;string&quot;&gt;&quot;\-\-ini conf/uwsgi.conf&quot;&lt;/span&gt;|awk -F &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;&amp;#123;print $2&amp;#125;&#39;&lt;/span&gt;|xargs sudo kill &lt;span class=&quot;number&quot;&gt;-9&lt;/span&gt;＂＂＂)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                result = run(&lt;span class=&quot;string&quot;&gt;&quot;sudo uwsgi --ini conf/uwsgi.conf&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; result.failed:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;launch failed&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;＃发布入口&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@task(alias=&quot;install&quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    commit_code()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    deploy_server()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;p&gt;执行fab install或者fab deploy结果如下：&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[127.0.0.1] Executing task &amp;apos;install&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[localhost] local: git pull origin master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;来自 github.com:brianfordream/blog&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * branch master -&amp;gt; FETCH_HEAD&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Already up-to-date.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[localhost] local: git add .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[localhost] local: git commit -m &amp;apos;auto commit&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;位于分支 master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;无文件要提交，干净的工作区&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Warning: local() encountered an error (return code 1) while executing &amp;apos;git commit -m &amp;apos;auto commit&amp;apos;&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[localhost] local: git push origin master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Everything up-to-date&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[127.0.0.1] run: sudo git pull origin master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[127.0.0.1] out: From https://github.com/brianfordream/blog&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[127.0.0.1] out: * branch master -&amp;gt; FETCH_HEAD&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[127.0.0.1] out: Already up-to-date.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[127.0.0.1] out: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[127.0.0.1] run: sudo uwsgi --ini conf/uwsgi.conf --reload pidfile&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[127.0.0.1] out: [uWSGI] getting INI configuration from conf/uwsgi.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[127.0.0.1] out: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Done.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Disconnecting from 127.0.0.1... done.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;通过fabric可以方便的在本地对本地和服务器执行shell操作，简化了发布过程．&lt;/p&gt;&lt;p&gt;注:env.use_ssh_config = True　#使用系统ssh配置&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;Python通用发布流程：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;git checkout - b workspace&lt;/li&gt;&lt;li&gt;编写逻辑&lt;/li&gt;&lt;li&gt;git add &amp;amp;&amp;amp; git commit &amp;amp;&amp;amp; git push&lt;/li&gt;&lt;li&gt;ssh登陆服务器&lt;/li&gt;&lt;li&gt;git pull&lt;/li&gt;&lt;li&gt;启动脚本&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;在每次修改代码之后，都需要执行git提交，登陆服务器，更新代码，启动代码．登陆服务器，更新代码是一项重复枯燥无味的工作．&lt;/p&gt;&lt;p&gt;python使用Fabric可以轻松的在本地用Pythonic的方式完成ssh连接和执行shell命令．快速入门&lt;/p&gt;&lt;p&gt;安装方法：&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo pip install fabric&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;以web开发为例，将更新的web代码提交到git,在服务器端通过git更新代码，并重启uwsgi服务器，fabric代码如下：&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#fabfile.py&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;__author__ = &lt;span class=&quot;string&quot;&gt;&#39;brianyang&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; fabric.api &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; local, settings, abort, cd, run, env, lcd, task&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; fabric.contrib.console &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; confirm&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; fabric.network &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; ssh&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ssh.util.log_to_file(&lt;span class=&quot;string&quot;&gt;&quot;paramiko.log&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env.hosts = [&lt;span class=&quot;string&quot;&gt;&#39;127.0.0.1&#39;&lt;/span&gt;]　　　&lt;span class=&quot;comment&quot;&gt;#服务器地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env.user = &lt;span class=&quot;string&quot;&gt;&#39;root&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env.key_filename = &lt;span class=&quot;string&quot;&gt;&quot;~/Documents/why.pem&quot;&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;#ssh私钥文件地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#本地提交代码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;commit_code&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    code_dir = &lt;span class=&quot;string&quot;&gt;&quot;/home/q/blog&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; settings(warn_only=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; lcd(code_dir):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            result = local(&lt;span class=&quot;string&quot;&gt;&quot;git pull origin master&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; result.failed &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; confirm(&lt;span class=&quot;string&quot;&gt;&quot;Pull failed, continue?&quot;&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                abort(&lt;span class=&quot;string&quot;&gt;&quot;abort!&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            local(&lt;span class=&quot;string&quot;&gt;&quot;git add .&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            local(&lt;span class=&quot;string&quot;&gt;&quot;git commit -m &#39;auto commit&#39;&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            local(&lt;span class=&quot;string&quot;&gt;&quot;git push origin master&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#服务器发布代码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;deploy_server&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    code_dir = &lt;span class=&quot;string&quot;&gt;&quot;/home/q/blog&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; settings(warn_only=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; cd(code_dir):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            run(&lt;span class=&quot;string&quot;&gt;&quot;sudo git pull origin master&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            result = run(&lt;span class=&quot;string&quot;&gt;&quot;sudo uwsgi --ini conf/uwsgi.conf  --reload pidfile&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; result.failed:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                run(&lt;span class=&quot;string&quot;&gt;&quot;sudo ps -ef|grep uwsgi&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                run(＂＂＂sudo ps -ef|grep &lt;span class=&quot;string&quot;&gt;&quot;\-\-ini conf/uwsgi.conf&quot;&lt;/span&gt;|awk -F &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;&amp;#123;print $2&amp;#125;&#39;&lt;/span&gt;|xargs sudo kill &lt;span class=&quot;number&quot;&gt;-9&lt;/span&gt;＂＂＂)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                result = run(&lt;span class=&quot;string&quot;&gt;&quot;sudo uwsgi --ini conf/uwsgi.conf&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; result.failed:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;launch failed&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;＃发布入口&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@task(alias=&quot;install&quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    commit_code()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    deploy_server()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="python" scheme="http://trytofix.com/categories/python/"/>
    
    
      <category term="fabric" scheme="http://trytofix.com/tags/fabric/"/>
    
  </entry>
  
  <entry>
    <title>测试谷歌地图</title>
    <link href="http://trytofix.com/2016/04/06/%E6%B5%8B%E8%AF%95%E8%B0%B7%E6%AD%8C%E5%9C%B0%E5%9B%BE/"/>
    <id>http://trytofix.com/2016/04/06/测试谷歌地图/</id>
    <published>2016-04-06T12:42:09.000Z</published>
    <updated>2016-04-12T11:01:41.170Z</updated>
    
    <content type="html">&lt;p&gt;我在:&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;&lt;/p&gt;&lt;div id=&quot;googleMap8456&quot; style=&quot;height:500px;width:100%;margin:0;padding:0&quot;&gt;&lt;/div&gt;&lt;style&gt;.gmnoprint img{max-width:none!important}&lt;/style&gt;&lt;script defer&gt;function makeMaps(){for(var o in window.hexoGmaps.maps)console.log(&quot;map #&quot;,o),window.hexoGmaps.maps[o]()}function loadScript(){window.hexoGmaps.googleScriptLoaded=!0;var o=document.createElement(&quot;script&quot;);o.type=&quot;text/javascript&quot;,o.src=&quot;http://www.google.cn/maps/api/js?key=AIzaSyAA2ThKRTD8tK4nl9s-AOP67u3GHsiz2RM&amp;v=3.exp&amp;callback=makeMaps&quot;,document.body.appendChild(o)}window.hexoGmaps=window.hexoGmaps||{maps:{}},window.hexoGmaps.maps.initgoogleMap8456=function(){var o={scrollwheel:!0,zoom:17,center:new window.google.maps.LatLng(39.9782805252,116.315163067)},e=document.getElementById(&quot;googleMap8456&quot;),a=new window.google.maps.Map(e,o),n={position:new window.google.maps.LatLng(39.9782805252,116.315163067),map:a,title:&quot;新中关购物中心&quot;,zIndex:0,icon:&quot;&quot;};new window.google.maps.Marker(n)},window.hexoGmaps.googleScriptLoaded||loadScript()&lt;/script&gt;&lt;p&gt;&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;我在:&lt;br&gt;
    
    </summary>
    
      <category term="生活" scheme="http://trytofix.com/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
  </entry>
  
  <entry>
    <title>使用七牛为静态资源加速-脚本自动完成</title>
    <link href="http://trytofix.com/2016/04/06/%E4%BD%BF%E7%94%A8%E4%B8%83%E7%89%9B%E4%B8%BA%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%8A%A0%E9%80%9F-%E8%84%9A%E6%9C%AC%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90/"/>
    <id>http://trytofix.com/2016/04/06/使用七牛为静态资源加速-脚本自动完成/</id>
    <published>2016-04-06T09:12:58.000Z</published>
    <updated>2016-04-12T11:01:41.174Z</updated>
    
    <content type="html">&lt;p&gt;hexo生成的都是静态文件,除了文章内容之外,大部分都是各种主题需要的js,css文件,如果将博客部署在github上,由于某些众所周知的原因,导致github下载速度非常慢,那么这些静态资源文件将会降低用户体验.&lt;/p&gt;&lt;p&gt;一个优化方法就是将博客部署在github上,而js,css等静态资源文件部署在国内的cdn上.七牛是一款使用广泛的存储空间,普通用户每月都会有免费额度,更关键的是,提供了多种语言的api,方便自动化管理.&lt;/p&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;p&gt;以本博客为例,通过&lt;code&gt;hexo g&lt;/code&gt;生成的静态文件位于public文件下:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;public/vendor&lt;/li&gt;&lt;li&gt;public/css&lt;/li&gt;&lt;li&gt;public/js&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/b8b708a7gw1f2n4h3zyntj208t08daaj&quot; alt=&quot;hexo_qiniu_1.png&quot;&gt;&lt;/p&gt;&lt;p&gt;在主题中引用这些文件的部分代码如下:&lt;/p&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;head.ejs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;%-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;css&lt;/span&gt;(&#39;&lt;span class=&quot;attr&quot;&gt;vendor&lt;/span&gt;/&lt;span class=&quot;attr&quot;&gt;open-sans&lt;/span&gt;/&lt;span class=&quot;attr&quot;&gt;styles&lt;/span&gt;&#39;+&#39;&lt;span class=&quot;attr&quot;&gt;.css&lt;/span&gt;&#39;) %&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;%-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;css&lt;/span&gt;(&#39;&lt;span class=&quot;attr&quot;&gt;vendor&lt;/span&gt;/&lt;span class=&quot;attr&quot;&gt;source-code-pro&lt;/span&gt;/&lt;span class=&quot;attr&quot;&gt;styles&lt;/span&gt;&#39;+&#39;&lt;span class=&quot;attr&quot;&gt;.css&lt;/span&gt;&#39;) %&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;%-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;css&lt;/span&gt;(&#39;&lt;span class=&quot;attr&quot;&gt;css&lt;/span&gt;/&lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;&#39;+&#39;&lt;span class=&quot;attr&quot;&gt;.css&lt;/span&gt;&#39;) %&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;对静态资源的引用走的依然是当前主机下的流量,当部署在github上时,加载静态资源非常慢.&lt;/p&gt;&lt;p&gt;以public/js/main.js为例进行说明:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;默认访问地址:&lt;code&gt;http://trytofix.com/js/main.js&lt;/code&gt; 由于机器部署在github上,实际是从github上加载main.js.在我这里平均用时180-200ms之间.&lt;/li&gt;&lt;li&gt;使用cdn地址: &lt;code&gt;http://7xiego.com1.z0.glb.clouddn.com/js/main.js&lt;/code&gt;,平均用时40-50ms.&lt;br&gt;使用cdn不仅访问速度明显提升,而且七牛还可以设置静态资源文件的缓存时间,通过在用户浏览器缓存静态资源文件加快网站的访问.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;下面将这些静态资源放到七牛中&lt;/p&gt;&lt;p&gt;根据七牛提供的api,编写上传静态文件的代码如下:&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# encoding:utf8&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;__author__ = &lt;span class=&quot;string&quot;&gt;&#39;brianyang&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; qiniu &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Auth, put_file&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; os&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; re&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;access_key = &lt;span class=&quot;string&quot;&gt;&#39;your access key&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;secret_key = &lt;span class=&quot;string&quot;&gt;&#39;your secret key&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;q = Auth(access_key, secret_key)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bucket_name = &lt;span class=&quot;string&quot;&gt;&#39;your bucket name&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vendor_dir = &lt;span class=&quot;string&quot;&gt;&#39;public/vendor&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;css_dir = &lt;span class=&quot;string&quot;&gt;&#39;public/css&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;js_dir = &lt;span class=&quot;string&quot;&gt;&#39;public/js&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;list_file&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(file_path)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; path &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; os.listdir(file_path):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        full_path = os.path.join(file_path, path)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; os.path.isfile(full_path):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            key = re.sub(&lt;span class=&quot;string&quot;&gt;r&quot;.*?public/&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;, full_path)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            token = q.upload_token(bucket_name, key, &lt;span class=&quot;number&quot;&gt;3600&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ret, info = put_file(token, key, full_path)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; (info)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; os.path.isdir(full_path):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            list_file(full_path)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;list_file(vendor_dir)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;list_file(css_dir)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;list_file(js_dir)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;blockquote&gt;&lt;p&gt;注意: 本地文件&lt;code&gt;/public/a/b/c/d.css&lt;/code&gt;上传到七牛,对应的文件名为&lt;code&gt;a/b/c/d.css&lt;/code&gt;,通过七牛给你的个性化地址+七牛文件名进行访问.&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;下面修改hexo主题的几个地方,以便可以使用cdn.&lt;/p&gt;&lt;p&gt;修改主题的_config.yml,添加&lt;/p&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cdn_prefix: http://your.qiniu.glb.clouddn.com/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;注意,这里的cdn_prefix请换成自己申请的七牛地址,还有最后一个&lt;code&gt;/&lt;/code&gt;一定不要忘记,如果不使用cdn,则置空即可.&lt;/p&gt;&lt;p&gt;修改主题下的layout中的引入css和js的文件,例如head.ejs中与本文开始对应的三行修改为&lt;/p&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;%-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;css&lt;/span&gt;(&lt;span class=&quot;attr&quot;&gt;theme.cdn_prefix&lt;/span&gt;+&#39;&lt;span class=&quot;attr&quot;&gt;vendor&lt;/span&gt;/&lt;span class=&quot;attr&quot;&gt;open-sans&lt;/span&gt;/&lt;span class=&quot;attr&quot;&gt;styles&lt;/span&gt;&#39;+&#39;&lt;span class=&quot;attr&quot;&gt;.css&lt;/span&gt;&#39;) %&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;%-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;css&lt;/span&gt;(&lt;span class=&quot;attr&quot;&gt;theme.cdn_prefix&lt;/span&gt;+&#39;&lt;span class=&quot;attr&quot;&gt;vendor&lt;/span&gt;/&lt;span class=&quot;attr&quot;&gt;source-code-pro&lt;/span&gt;/&lt;span class=&quot;attr&quot;&gt;styles&lt;/span&gt;&#39;+&#39;&lt;span class=&quot;attr&quot;&gt;.css&lt;/span&gt;&#39;) %&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;%-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;css&lt;/span&gt;(&lt;span class=&quot;attr&quot;&gt;theme.cdn_prefix&lt;/span&gt;+&#39;&lt;span class=&quot;attr&quot;&gt;css&lt;/span&gt;/&lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;&#39;+&#39;&lt;span class=&quot;attr&quot;&gt;.css&lt;/span&gt;&#39;) %&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;这样做的好处是,当需要更换cdn时,仅需修改_config.yml中的cdn_prefix就可以了.&lt;/p&gt;&lt;p&gt;如果的你的网站在国内备案了,通过上面的脚本,甚至可以全站上传到七牛,通过cdn来加速全站,效果更佳.&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;hexo生成的都是静态文件,除了文章内容之外,大部分都是各种主题需要的js,css文件,如果将博客部署在github上,由于某些众所周知的原因,导致github下载速度非常慢,那么这些静态资源文件将会降低用户体验.&lt;/p&gt;&lt;p&gt;一个优化方法就是将博客部署在github上,而js,css等静态资源文件部署在国内的cdn上.七牛是一款使用广泛的存储空间,普通用户每月都会有免费额度,更关键的是,提供了多种语言的api,方便自动化管理.&lt;/p&gt;
    
    </summary>
    
      <category term="python" scheme="http://trytofix.com/categories/python/"/>
    
    
      <category term="cdn加速" scheme="http://trytofix.com/tags/cdn%E5%8A%A0%E9%80%9F/"/>
    
  </entry>
  
  <entry>
    <title>hexo添加404页面</title>
    <link href="http://trytofix.com/2016/04/06/hexo%E6%B7%BB%E5%8A%A0404%E9%A1%B5%E9%9D%A2/"/>
    <id>http://trytofix.com/2016/04/06/hexo添加404页面/</id>
    <published>2016-04-06T09:01:43.000Z</published>
    <updated>2016-04-12T11:01:41.174Z</updated>
    
    <content type="html">&lt;p&gt;为部署在github上的hexo添加自定义的404页面&lt;/p&gt;&lt;p&gt;在source下新建404.html&lt;/p&gt;&lt;p&gt;实现404页面到首页自动跳转,404.html内容如下:&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;html&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;lang&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;en&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;meta&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;charset&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;meta&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;http-equiv&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;refresh&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;content&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;2;url=/&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;404&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;h1&lt;/span&gt;&amp;gt;&lt;/span&gt;页面没有找到,跳转到主页...&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;h1&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;http://ww1.sinaimg.cn/small/b8b708a7gw1f2n307j0vlj206l064dfs.jpg&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;打开&lt;a href=&quot;http://trytofix.com/404&quot;&gt;本站404效果&lt;/a&gt;查看效果吧!&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;为部署在github上的hexo添加自定义的404页面&lt;/p&gt;&lt;p&gt;在source下新建404.html&lt;/p&gt;&lt;p&gt;实现404页面到首页自动跳转,404.html内容如下:&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;html&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;lt
    
    </summary>
    
      <category term="hexo" scheme="http://trytofix.com/categories/hexo/"/>
    
    
      <category term="404" scheme="http://trytofix.com/tags/404/"/>
    
  </entry>
  
  <entry>
    <title>hexo使用新浪微博图床自动部署</title>
    <link href="http://trytofix.com/2016/04/06/hexo%E4%BD%BF%E7%94%A8%E6%96%B0%E6%B5%AA%E5%BE%AE%E5%8D%9A%E5%9B%BE%E5%BA%8A%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2/"/>
    <id>http://trytofix.com/2016/04/06/hexo使用新浪微博图床自动部署/</id>
    <published>2016-04-06T08:00:55.000Z</published>
    <updated>2016-04-12T11:01:41.174Z</updated>
    
    <content type="html">&lt;p&gt;使用新浪微博图床请先参考之前两篇文章:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;/2016/04/06/python模拟微博登陆/&quot;&gt;python模拟微博登陆&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;/2016/04/06/使用新浪微博图床/&quot;&gt;使用新浪微博图床&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;自动部署涉及到以下文章:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;/2016/03/30/Linux-expect-与交互程序对话/&quot;&gt;Linux-expect-与交互程序对话&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;项目地址:&lt;a href=&quot;https://github.com/trytofix/hexo_weibo_image&quot; rel=&quot;external nofollow&quot; target=&quot;_blank&quot;&gt;代码地址&lt;/a&gt;&lt;/p&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;p&gt;工程中的文件包括:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;deploy.py 自动部署入口 &lt;code&gt;python deploy.py&lt;/code&gt; 启动自动部署&lt;/li&gt;&lt;li&gt;expect.sh github自动部署&lt;/li&gt;&lt;li&gt;image.db 新浪图床db&lt;/li&gt;&lt;li&gt;install.sh hexo自动部署&lt;/li&gt;&lt;li&gt;weibo_util.py 微博模拟登陆+图床&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;Linux + hexo + python + github运行环境可以直接clone工程到本地,将工程中的文件拷贝到hexo博客的根目录,例如/home/hexo/blog下,修改expect.sh中的用户名密码为自己的github的用户名密码,随后运行python deploy.py,输入新浪微博用户名和密码就可以将博客一键部署到github,并将博文中的图片替换为新浪图床的图片,示例网站:&lt;a href=&quot;http://trytofix.com&quot;&gt;http://trytofix.com&lt;/a&gt;. 其他环境的用户,可根据下面对每个文件的解释,各取所需.&lt;/p&gt;&lt;p&gt;Linux 需要安装expect, &lt;code&gt;sudo apt-get install expect&lt;/code&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 id=&quot;weibo-util-py-用来模拟登陆微博-将本地图片上传到新浪图床-并获取图床的链接&quot;&gt;&lt;a href=&quot;#weibo-util-py-用来模拟登陆微博-将本地图片上传到新浪图床-并获取图床的链接&quot; class=&quot;headerlink&quot; title=&quot;weibo_util.py 用来模拟登陆微博,将本地图片上传到新浪图床,并获取图床的链接.&quot;&gt;&lt;/a&gt;weibo_util.py 用来模拟登陆微博,将本地图片上传到新浪图床,并获取图床的链接.&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; __name__ == &lt;span class=&quot;string&quot;&gt;&#39;__main__&#39;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; get_image(&lt;span class=&quot;string&quot;&gt;&#39;/home/q/hexo/blog/source/img/angular-remove-table-item.jpg&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;修改get_image()中的路径为本机电脑上的路径,随后python weibo_util.py就可以查看效果,第一次使用,会提示输入新浪微博的用户名和密码,程序运行成功后返回图床的url地址.&lt;/p&gt;&lt;h3 id=&quot;install-sh-一个简单的发布脚本-集成了hexo发布的三个步骤-clean-generate-deploy-注意最后一行的expect-sh-介绍在下面&quot;&gt;&lt;a href=&quot;#install-sh-一个简单的发布脚本-集成了hexo发布的三个步骤-clean-generate-deploy-注意最后一行的expect-sh-介绍在下面&quot; class=&quot;headerlink&quot; title=&quot;install.sh 一个简单的发布脚本,集成了hexo发布的三个步骤: clean, generate, deploy,注意最后一行的expect.sh,介绍在下面.&quot;&gt;&lt;/a&gt;install.sh 一个简单的发布脚本,集成了hexo发布的三个步骤: clean, generate, deploy,注意最后一行的expect.sh,介绍在下面.&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hexo clean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hexo g&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;./expect.sh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&quot;expect-sh-部署hexo到github时-需要输入用户名和密码-使用expect可以自动输入用户名和密码-将&quot;&gt;&lt;a href=&quot;#expect-sh-部署hexo到github时-需要输入用户名和密码-使用expect可以自动输入用户名和密码-将&quot; class=&quot;headerlink&quot; title=&quot;expect.sh 部署hexo到github时,需要输入用户名和密码,使用expect可以自动输入用户名和密码,将&quot;&gt;&lt;/a&gt;expect.sh 部署hexo到github时,需要输入用户名和密码,使用expect可以自动输入用户名和密码,将&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;set user yourusername&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set pass yourpassword&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;替换为自己的github的用户名和密码.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;如果不需要将博客部署到github,请在install.sh中注释./expect.sh或替换为hexo d&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 id=&quot;deploy-py部署hexo博客&quot;&gt;&lt;a href=&quot;#deploy-py部署hexo博客&quot; class=&quot;headerlink&quot; title=&quot;deploy.py部署hexo博客&quot;&gt;&lt;/a&gt;deploy.py部署hexo博客&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;将_posts下的文章备份&lt;/li&gt;&lt;li&gt;遍历所有的文章,找到&lt;code&gt;![image_alt](image_url)&lt;/code&gt;标准markdown格式的image_url,其中image_url的格式应为’/img/xxx.jpg’,位于source/img下&lt;/li&gt;&lt;li&gt;通过weibo_util获取改图片的图床地址并替换&lt;/li&gt;&lt;li&gt;执行install.sh,生成图片地址为图床地址的博客页面&lt;/li&gt;&lt;li&gt;将文章备份替换回来,_posts下的文章中的图片仍为markdown格式.&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;为了避免每次部署时,都生成新的图床url(浪费资源可耻,感谢新浪无私的没有做防盗链限制),在部署时,将图片做md5计算,将md5与新浪图床url存入map,最后使用json持久化到文件中(image.db),每次部署先查看md5是否存在map中,如果存在,则直接取md5对应的value值,否则,获取图床地址并存入image.db.&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 id=&quot;image-db存放图片md5与图床url对应关系的json数据库&quot;&gt;&lt;a href=&quot;#image-db存放图片md5与图床url对应关系的json数据库&quot; class=&quot;headerlink&quot; title=&quot;image.db存放图片md5与图床url对应关系的json数据库&quot;&gt;&lt;/a&gt;image.db存放图片md5与图床url对应关系的json数据库&lt;/h3&gt;&lt;p&gt;感谢新浪提供的图床,避免相同的图片每次都生成新的图床地址,浪费资源.&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;使用新浪微博图床请先参考之前两篇文章:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;/2016/04/06/python模拟微博登陆/&quot;&gt;python模拟微博登陆&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;/2016/04/06/使用新浪微博图床/&quot;&gt;使用新浪微博图床&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;自动部署涉及到以下文章:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;/2016/03/30/Linux-expect-与交互程序对话/&quot;&gt;Linux-expect-与交互程序对话&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;项目地址:&lt;a href=&quot;https://github.com/trytofix/hexo_weibo_image&quot; rel=&quot;external nofollow&quot; target=&quot;_blank&quot;&gt;代码地址&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="python" scheme="http://trytofix.com/categories/python/"/>
    
    
      <category term="hexo一键部署" scheme="http://trytofix.com/tags/hexo%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2/"/>
    
  </entry>
  
  <entry>
    <title>使用新浪微博图床</title>
    <link href="http://trytofix.com/2016/04/06/%E4%BD%BF%E7%94%A8%E6%96%B0%E6%B5%AA%E5%BE%AE%E5%8D%9A%E5%9B%BE%E5%BA%8A/"/>
    <id>http://trytofix.com/2016/04/06/使用新浪微博图床/</id>
    <published>2016-04-06T07:22:30.000Z</published>
    <updated>2016-04-12T11:01:41.178Z</updated>
    
    <content type="html">&lt;p&gt;首先感谢新浪微博提供的免费图床(对外链无限制),以及吊炸天的cdn图片加速服务,从此妈妈再也不用担心我的图床不能用了.&lt;/p&gt;&lt;h3 id=&quot;图床原理&quot;&gt;&lt;a href=&quot;#图床原理&quot; class=&quot;headerlink&quot; title=&quot;图床原理:&quot;&gt;&lt;/a&gt;图床原理:&lt;/h3&gt;&lt;p&gt;访问&lt;code&gt;http://weibo.com/minipublish&lt;/code&gt;&lt;/p&gt;&lt;p&gt;使用新浪微博账号登陆&lt;/p&gt;&lt;p&gt;进入到发微博的界面:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/b8b708a7gw1f2n1zyhpanj20dr085aaw&quot; alt=&quot;weibo_upload_image_1&quot;&gt;&lt;/p&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;p&gt;点击下方的上传图片按钮,并上传本地图片,上传成功后,会在下方出现一张预览图,打开控制台找到这张图片的url,这就是新浪图床的url.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;不需要发布微博,图片只要上传就会存在于图床中&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/b8b708a7gw1f2n1zyweqaj211u0jfqa7&quot; alt=&quot;weibo_upload_image_2&quot;&gt;&lt;/p&gt;&lt;p&gt;手动上传图片,获取地址,非常繁琐.在这里使用python写了一个上传本地图片并返回图床url的脚本,在使用前,请参看另一篇博客&lt;a href=&quot;/2016/04/06/python模拟微博登陆/&quot;&gt;python模拟微博登陆&lt;/a&gt;,介绍了如何使用python登陆新浪微博并保存cookie.&lt;/p&gt;&lt;p&gt;在获取到cookie后,就可以使用cookie上传图片,代码如下:&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;request_image_url&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(image_path)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cookie = cookielib.MozillaCookieJar()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cookie.load(cookie_file, ignore_expires=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;, ignore_discard=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookie))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    image_url = &lt;span class=&quot;string&quot;&gt;&#39;http://picupload.service.weibo.com/interface/pic_upload.php?mime=image%2Fjpeg&amp;amp;data=base64&amp;amp;url=0&amp;amp;markpos=1&amp;amp;logo=&amp;amp;nick=0&amp;amp;marks=1&amp;amp;app=miniblog&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    b = base64.b64encode(file(image_path).read())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    data = urllib.urlencode(&amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;b64_data&#39;&lt;/span&gt;: b&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    result = opener.open(image_url, data).read()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    result = re.sub(&lt;span class=&quot;string&quot;&gt;r&quot;&amp;lt;meta.*&amp;lt;/script&amp;gt;&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;, result)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    image_result = json.loads(result)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    image_id = image_result.get(&lt;span class=&quot;string&quot;&gt;&#39;data&#39;&lt;/span&gt;).get(&lt;span class=&quot;string&quot;&gt;&#39;pics&#39;&lt;/span&gt;).get(&lt;span class=&quot;string&quot;&gt;&#39;pic_1&#39;&lt;/span&gt;).get(&lt;span class=&quot;string&quot;&gt;&#39;pid&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;http://ww3.sinaimg.cn/large/%s&#39;&lt;/span&gt; % image_id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;get_image&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(image_path)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    url = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        url = request_image_url(image_path)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            username = raw_input(&lt;span class=&quot;string&quot;&gt;&quot;输入新浪微博用户名：&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            password = raw_input(&lt;span class=&quot;string&quot;&gt;&quot;输入新浪微博密码：&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            nonce, pubkey, servertime, rsakv = pre_login()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            form_data = generate_form_data(nonce, pubkey, servertime, rsakv, username, password)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            login(form_data)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            url = request_image_url(image_path)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;登录失败,程序退出&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            exit()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; url&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; __name__ == &lt;span class=&quot;string&quot;&gt;&#39;__main__&#39;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; get_image(&lt;span class=&quot;string&quot;&gt;&#39;/home/q/hexo/blog/source/img/angular-remove-table-item.jpg&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;代码运行结果如下:&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/usr/bin/python2.7 /home/q/hexo/blog/weibo_util.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;输入新浪微博用户名： yourusername&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;输入新浪微博密码：yourpassword&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;http://ww3.sinaimg.cn/large/b8b708a7gw1f2n0udn29tj210b0b0jsn&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;输出就是新浪图床的地址.换成你的本地文件来试一试吧.&lt;/p&gt;&lt;p&gt;完整的代码包括了模拟新浪微博登陆,保存cookie,上传本地图片到新浪微博图床并获取图床地址.&lt;/p&gt;&lt;p&gt;完整的代码请参照:&lt;a href=&quot;https://github.com/trytofix/hexo_weibo_image/blob/master/weibo_util.py&quot; rel=&quot;external nofollow&quot; target=&quot;_blank&quot;&gt;模拟微博登陆并获取图床地址&lt;/a&gt;&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;首先感谢新浪微博提供的免费图床(对外链无限制),以及吊炸天的cdn图片加速服务,从此妈妈再也不用担心我的图床不能用了.&lt;/p&gt;&lt;h3 id=&quot;图床原理&quot;&gt;&lt;a href=&quot;#图床原理&quot; class=&quot;headerlink&quot; title=&quot;图床原理:&quot;&gt;&lt;/a&gt;图床原理:&lt;/h3&gt;&lt;p&gt;访问&lt;code&gt;http://weibo.com/minipublish&lt;/code&gt;&lt;/p&gt;&lt;p&gt;使用新浪微博账号登陆&lt;/p&gt;&lt;p&gt;进入到发微博的界面:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/b8b708a7gw1f2n1zyhpanj20dr085aaw&quot; alt=&quot;weibo_upload_image_1&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="python" scheme="http://trytofix.com/categories/python/"/>
    
    
      <category term="新浪图床" scheme="http://trytofix.com/tags/%E6%96%B0%E6%B5%AA%E5%9B%BE%E5%BA%8A/"/>
    
  </entry>
  
  <entry>
    <title>python模拟微博登陆</title>
    <link href="http://trytofix.com/2016/04/06/python%E6%A8%A1%E6%8B%9F%E5%BE%AE%E5%8D%9A%E7%99%BB%E9%99%86/"/>
    <id>http://trytofix.com/2016/04/06/python模拟微博登陆/</id>
    <published>2016-04-06T05:31:00.000Z</published>
    <updated>2016-04-12T11:01:41.174Z</updated>
    
    <content type="html">&lt;p&gt;通过网上各种查阅资料以及自己的亲身实践,终于实现了使用python对新浪微博的模拟登陆,模拟登陆新浪微博主要分为三个部分:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;预登陆 用来获取登陆所需信息.这些信息用来加密传输数据,并提交给服务器做验证.&lt;/li&gt;&lt;li&gt;生成提交表单&lt;ul&gt;&lt;li&gt;生成用户名&lt;/li&gt;&lt;li&gt;生成密码&lt;/li&gt;&lt;li&gt;生成其他必须字段&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;登陆并保存cookie&lt;ul&gt;&lt;li&gt;请求登陆url并提交表单&lt;/li&gt;&lt;li&gt;登陆成功后需要打开跳转页面完成登陆&lt;/li&gt;&lt;li&gt;保存cookie,以便之后使用&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 id=&quot;预登陆&quot;&gt;&lt;a href=&quot;#预登陆&quot; class=&quot;headerlink&quot; title=&quot;预登陆&quot;&gt;&lt;/a&gt;预登陆&lt;/h3&gt;&lt;p&gt;预登陆请求的url地址为&lt;code&gt;http://login.sina.com.cn/sso/prelogin.php?entry=weibo&amp;amp;callback=sinaSSOController.preloginCallBack&amp;amp;su=ZW5nbGFuZHNldSU0MDE2My5jb20%3D&amp;amp;rsakt=mod&amp;amp;checkpin=1&amp;amp;cli&lt;/code&gt;,返回的数据是一个包含了json数据的html页面,通过正则表达式可以截取到json数据.&lt;br&gt;每次请求时url返回的数据都是不一样的,某次请求数据如下:&lt;/p&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sinaSSOController.preloginCallBack(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;retcode: 0,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;servertime: 1459925087,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pcid: &quot;gz-735ae223662fe03ed41939ba1616f11a07ad&quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nonce: &quot;NVPC1L&quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pubkey: &quot;EB2A38568661887FA180BDDB5CABD5F21C7BFD59C090CB2D245A87AC253062882729293E5506350508E7F9AA3BB77F4333231490F915F6D63C55FE2F08A49B353F444AD3993CACC02DB784ABBB8E42A9B1BBFFFB38BE18D78E87A0E41B9B8F73A928EE0CCEE1F6739884B9777E4FE9E88A1BBE495927AC4A799B3181D6442443&quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rsakv: &quot;1330428213&quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;is_openlock: 0,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;showpin: 1,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;exectime: 69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;注意其中的servertime,nonce,pubkey,rsakv这字段是非常重要的,通过处理拿到这四个值.&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;pre_login&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    pre_login_url = &lt;span class=&quot;string&quot;&gt;&#39;http://login.sina.com.cn/sso/prelogin.php?entry=weibo&amp;amp;callback=sinaSSOController.preloginCallBack&amp;amp;su=MTUyNTUxMjY3OTY%3D&amp;amp;rsakt=mod&amp;amp;checkpin=1&amp;amp;client=ssologin.js%28v1.4.18%29&amp;amp;_=1458836718537&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    pre_response = requests.get(pre_login_url).text&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    pre_content_regex = &lt;span class=&quot;string&quot;&gt;r&#39;\((.*?)\)&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    patten = re.search(pre_content_regex, pre_response)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    nonce = &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    pubkey = &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    servertime = &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    rsakv = &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; patten.groups():&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pre_content = patten.group(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pre_result = json.loads(pre_content)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        nonce = pre_result.get(&lt;span class=&quot;string&quot;&gt;&quot;nonce&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pubkey = pre_result.get(&lt;span class=&quot;string&quot;&gt;&#39;pubkey&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        servertime = pre_result.get(&lt;span class=&quot;string&quot;&gt;&#39;servertime&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        rsakv = pre_result.get(&lt;span class=&quot;string&quot;&gt;&quot;rsakv&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; nonce, pubkey, servertime, rsakv&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;h3 id=&quot;生成提交表单&quot;&gt;&lt;a href=&quot;#生成提交表单&quot; class=&quot;headerlink&quot; title=&quot;生成提交表单&quot;&gt;&lt;/a&gt;生成提交表单&lt;/h3&gt;&lt;p&gt;既然是模拟登陆,用户名和密码就是最重要的两项&lt;/p&gt;&lt;ul&gt;&lt;li&gt;用户名使用base64编码&lt;/li&gt;&lt;li&gt;密码编码较为复杂:&lt;ul&gt;&lt;li&gt;通过预登陆得到的pubkey的十进制(n)与65537(e)生成rsa公钥&lt;/li&gt;&lt;li&gt;将预登陆得到的servertime,nonce和password拼接成字符串&lt;/li&gt;&lt;li&gt;将第二步得到的字符串使用第一步生成的公钥加密&lt;/li&gt;&lt;li&gt;将第三步得到的二进制加密数据转换为十六进制的数据,转换后的数据就是需要提交的密码&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;generate_form_data&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(nonce, pubkey, servertime, rsakv, username, password)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    rsa_public_key = int(pubkey, &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    key = rsa.PublicKey(rsa_public_key, &lt;span class=&quot;number&quot;&gt;65537&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    message = str(servertime) + &lt;span class=&quot;string&quot;&gt;&#39;\t&#39;&lt;/span&gt; + str(nonce) + &lt;span class=&quot;string&quot;&gt;&#39;\n&#39;&lt;/span&gt; + str(password)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    passwd = rsa.encrypt(message, key)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    passwd = binascii.b2a_hex(passwd)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    username = urllib2.quote(username)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    username = base64.encodestring(username)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    form_data = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;entry&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;weibo&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;gateway&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;1&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;from&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;savestate&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;7&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;useticket&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;1&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;pagerefer&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;http://weibo.com/p/1005052679342531/home?from=page_100505&amp;amp;mod=TAB&amp;amp;pids=plc_main&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;vsnf&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;1&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;su&#39;&lt;/span&gt;: username,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;service&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;miniblog&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;servertime&#39;&lt;/span&gt;: servertime,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;nonce&#39;&lt;/span&gt;: nonce,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;pwencode&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;rsa2&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;rsakv&#39;&lt;/span&gt;: rsakv,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;sp&#39;&lt;/span&gt;: passwd,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;sr&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;1366*768&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;encoding&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;UTF-8&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;prelt&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;115&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;url&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;http://weibo.com/ajaxlogin.php?framelogin=1&amp;amp;callback=parent.sinaSSOController.feedBackUrlCallBack&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;returntype&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;META&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    form_data = urllib.urlencode(form_data)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; form_data&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&quot;登陆并保存cookie&quot;&gt;&lt;a href=&quot;#登陆并保存cookie&quot; class=&quot;headerlink&quot; title=&quot;登陆并保存cookie&quot;&gt;&lt;/a&gt;登陆并保存cookie&lt;/h3&gt;&lt;p&gt;通过cookielib保存登陆成功后的cookie.注意下段代码中的&lt;code&gt;login_url&lt;/code&gt;,这是登陆成功后的跳转界面,只有成功跳转,才算登陆成功.&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(form_data)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    url = &lt;span class=&quot;string&quot;&gt;&#39;http://login.sina.com.cn/sso/login.php?client=ssologin.js(v1.4.18)&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    headers = (&lt;span class=&quot;string&quot;&gt;&#39;User-Agent&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;Mozilla/5.0 (Windows NT 6.3; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cookie = cookielib.MozillaCookieJar(cookie_file)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    handler = urllib2.HTTPCookieProcessor(cookie)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    opener = urllib2.build_opener(handler)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    opener.addheaders.append(headers)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    req = opener.open(url, form_data)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    redirect_result = req.read()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    login_pattern = &lt;span class=&quot;string&quot;&gt;r&#39;location.replace\(\&#39;(.*?)\&#39;\)&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    login_url = re.search(login_pattern, redirect_result).group(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    opener.open(login_url).read()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cookie.save(cookie_file, ignore_discard=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;, ignore_expires=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;完整的可运行代码请参照&lt;a href=&quot;https://github.com/trytofix/hexo_weibo_image/blob/master/weibo_util.py&quot; rel=&quot;external nofollow&quot; target=&quot;_blank&quot;&gt;weibo_util.py&lt;/a&gt;&lt;/p&gt;&lt;p&gt;参考内容:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/andrewseu/article/details/48730735&quot; rel=&quot;external nofollow&quot; target=&quot;_blank&quot;&gt;python模拟登录新浪微博&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://cuiqingcai.com/968.html&quot; rel=&quot;external nofollow&quot; target=&quot;_blank&quot;&gt;Python爬虫入门六之Cookie的使用&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/yuxc/archive/2011/08/01/2123995.html&quot; rel=&quot;external nofollow&quot; target=&quot;_blank&quot;&gt;Python 标准库 urllib2 的使用细节&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;通过网上各种查阅资料以及自己的亲身实践,终于实现了使用python对新浪微博的模拟登陆,模拟登陆新浪微博主要分为三个部分:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;预登陆 用来获取登陆所需信息.这些信息用来加密传输数据,并提交给服务器做验证.&lt;/li&gt;&lt;li&gt;生成提交表单&lt;ul&gt;&lt;li&gt;生成用户名&lt;/li&gt;&lt;li&gt;生成密码&lt;/li&gt;&lt;li&gt;生成其他必须字段&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;登陆并保存cookie&lt;ul&gt;&lt;li&gt;请求登陆url并提交表单&lt;/li&gt;&lt;li&gt;登陆成功后需要打开跳转页面完成登陆&lt;/li&gt;&lt;li&gt;保存cookie,以便之后使用
    
    </summary>
    
      <category term="python" scheme="http://trytofix.com/categories/python/"/>
    
    
      <category term="微博登陆" scheme="http://trytofix.com/tags/%E5%BE%AE%E5%8D%9A%E7%99%BB%E9%99%86/"/>
    
  </entry>
  
  <entry>
    <title>python生成md5值</title>
    <link href="http://trytofix.com/2016/04/05/python%E7%94%9F%E6%88%90md5%E5%80%BC/"/>
    <id>http://trytofix.com/2016/04/05/python生成md5值/</id>
    <published>2016-04-05T04:03:40.000Z</published>
    <updated>2016-04-12T11:01:41.170Z</updated>
    
    <content type="html">&lt;p&gt;使用md5模块(the md5 module is deprecated; use hashlib instead):&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; md5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;src = &lt;span class=&quot;string&quot;&gt;&#39;this is a md5 test.&#39;&lt;/span&gt;   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;m1 = md5.new()   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;m1.update(src)   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; m1.hexdigest()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;使用hashlib模块(推荐)&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; hashlib   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;src = &lt;span class=&quot;string&quot;&gt;&#39;this is a md5 test.&#39;&lt;/span&gt;   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;m2 = hashlib.md5()   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;m2.update(src)   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; m2.hexdigest()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;使用md5模块(the md5 module is deprecated; use hashlib instead):&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span 
    
    </summary>
    
      <category term="python" scheme="http://trytofix.com/categories/python/"/>
    
    
      <category term="md5" scheme="http://trytofix.com/tags/md5/"/>
    
  </entry>
  
  <entry>
    <title>python简单http服务器</title>
    <link href="http://trytofix.com/2016/03/30/python%E7%AE%80%E5%8D%95http%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    <id>http://trytofix.com/2016/03/30/python简单http服务器/</id>
    <published>2016-03-30T12:20:52.000Z</published>
    <updated>2016-04-12T11:01:41.166Z</updated>
    
    <content type="html">&lt;p&gt;有时需要下载服务器上的文件到本地，大部分linux服务器默认安装python,所以最简单的方法是进入文件所在的文件夹，然后执行：&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo python -m SimpleHTTPServer 80&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;之后通过&lt;a href=&quot;http://服务器地址:端口号&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://服务器地址:端口号&lt;/a&gt; 就可以访问文件夹中的内容，点击文件就可以下载．&lt;br&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/b8b708a7gw1f2louyxiwgj20eo0dq40e&quot; alt=&quot;python http server&quot;&gt;&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;有时需要下载服务器上的文件到本地，大部分linux服务器默认安装python,所以最简单的方法是进入文件所在的文件夹，然后执行：&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;s
    
    </summary>
    
      <category term="python" scheme="http://trytofix.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>Linux expect-与交互程序对话</title>
    <link href="http://trytofix.com/2016/03/30/Linux-expect-%E4%B8%8E%E4%BA%A4%E4%BA%92%E7%A8%8B%E5%BA%8F%E5%AF%B9%E8%AF%9D/"/>
    <id>http://trytofix.com/2016/03/30/Linux-expect-与交互程序对话/</id>
    <published>2016-03-30T09:18:57.000Z</published>
    <updated>2016-04-12T11:01:41.170Z</updated>
    
    <content type="html">&lt;p&gt;在写shell脚本实现某些需要交互的程序，例如向github提交代码时，https连接方式下，会提示输入用户名和密码，使用shell无法完成自动输入完成交互的功能．&lt;/p&gt;&lt;p&gt;expect的出现，解决了这一问题．expect用于：programmed dialogue with interactive programs.expect专为交互程序而生！&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;安装expect&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;sudo apt-get install expect&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;expect扩展了shell的语法，使用时需要在文件的第一行注明：&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#!/usr/bin/expect&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;而不是&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;下面我们通过例子简单学习下使用expect如何自动输入github的用户名和密码，当执行hexo d(部署hexo工程)时，会提示如下：&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;brianyang@brianyang-Latitude-E5440:/home/q/hexo/blog$ hexo d&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO  Deploying: git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO  Clearing .deploy_git folder...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO  Copying files from public folder...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;位于分支 master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;无文件要提交，干净的工作区&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Username for &amp;apos;https://github.com&amp;apos;:&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;编写expect.sh脚本:&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#!/usr/bin/expect&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set user username&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set pass password&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;spawn hexo d&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;expect &amp;quot;Username&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;send &amp;quot;$user\r&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;expect &amp;quot;Password&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;send &amp;quot;$pass\r&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;interact&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;下面逐行解释下上面的代码&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#!/usr/bin/expect&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;使用/usr/bin/expect执行代码&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;set user username&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set pass password&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;设置两个变量存储用户名和密码&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;spawn hexo d&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;spawn用于创建一个新的进程执行后面的命令&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;expect &amp;quot;Username&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;send &amp;quot;$user\r&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;expect &amp;quot;Password&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;send &amp;quot;$pass\r&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;expect用来判断程序上一个输出的结果是否包含”Username”这个字符串,如果有就立即返回，否则就等待一段时间后返回(通过set timeout 30设置)．&lt;/p&gt;&lt;p&gt;send用来执行交互动作，当expect “Username”返回时，send用户名,记得结尾处的\r，用来表示输入结束．&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;interact&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;执行完成后保持交互状态，把控制权交给控制台，这个时候就可以继续执行其他控制台命令了.如果没有这一句登录完成后会退出．&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;chmod +x expect.sh&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;./expect.sh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;试试效果吧！&lt;/p&gt;&lt;p&gt;更多用法和说明请执行: &lt;code&gt;man expect&lt;/code&gt;, 自己动手，丰衣足食～&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;在写shell脚本实现某些需要交互的程序，例如向github提交代码时，https连接方式下，会提示输入用户名和密码，使用shell无法完成自动输入完成交互的功能．&lt;/p&gt;&lt;p&gt;expect的出现，解决了这一问题．expect用于：programmed dialogue with interactive programs.expect专为交互程序而生！&lt;br&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://trytofix.com/categories/Linux/"/>
    
    
      <category term="Linux Command" scheme="http://trytofix.com/tags/Linux-Command/"/>
    
      <category term="Hexo系列" scheme="http://trytofix.com/tags/Hexo%E7%B3%BB%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>vim操作多个文件</title>
    <link href="http://trytofix.com/2016/03/30/vim%E6%93%8D%E4%BD%9C%E5%A4%9A%E4%B8%AA%E6%96%87%E4%BB%B6/"/>
    <id>http://trytofix.com/2016/03/30/vim操作多个文件/</id>
    <published>2016-03-30T08:49:09.000Z</published>
    <updated>2016-04-12T11:01:41.170Z</updated>
    
    <content type="html">&lt;p&gt;打开多个文件:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;vim还没启动:&lt;ul&gt;&lt;li&gt;vim file1 file2&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;vim已经启动:&lt;ul&gt;&lt;li&gt;:open file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;p&gt;多个文件间切换：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ctrl+6 下一个文件&lt;/li&gt;&lt;li&gt;:bn 下一个文件&lt;/li&gt;&lt;li&gt;:bp 上一个文件&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;同时显示多个文件:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;水平显示:&lt;ul&gt;&lt;li&gt;:sp file&lt;/li&gt;&lt;li&gt;:split file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;垂直显示:&lt;ul&gt;&lt;li&gt;:vsp file&lt;/li&gt;&lt;li&gt;:vsplit file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;多个窗格之间切换&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ctrl+w+方向键 切换到上／下／左／右的窗格&lt;/li&gt;&lt;li&gt;ctrl+w+h/j/k/l 同上&lt;/li&gt;&lt;li&gt;ctrl+ww 依此向后切换到下一个窗格中&lt;/li&gt;&lt;/ul&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;打开多个文件:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;vim还没启动:&lt;ul&gt;&lt;li&gt;vim file1 file2&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;vim已经启动:&lt;ul&gt;&lt;li&gt;:open file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://trytofix.com/categories/Linux/"/>
    
    
  </entry>
  
  <entry>
    <title>base64加密/解密</title>
    <link href="http://trytofix.com/2016/03/30/base64%E5%8A%A0%E5%AF%86_%E8%A7%A3%E5%AF%86/"/>
    <id>http://trytofix.com/2016/03/30/base64加密_解密/</id>
    <published>2016-03-30T08:20:29.000Z</published>
    <updated>2016-04-12T11:01:41.166Z</updated>
    
    <content type="html">&lt;blockquote&gt;&lt;p&gt;Base64是一种基于64个可打印字符来表示二进制数据的表示方法。由于2的6次方等于64，所以每6个比特为一个单元，对应某个可打印字符。三个字节有24个比特，对应于4个Base64单元，即3个字节需要用4个可打印字符来表示。它可用来作为电子邮件的传输编码。在Base64中的可打印字符包括字母A-Z、a-z、数字0-9，这样共有62个字符，此外两个可打印符号在不同的系统中而不同。(摘自:维基百科)&lt;br&gt;Base64常用于在通常处理文本数据的场合，表示、传输、存储一些二进制数据。包括MIME的email、在XML中存储复杂数据。&lt;/p&gt;&lt;/blockquote&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;p&gt;使用说明:&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;NAME&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       base64 - base64 encode/decode data and print to standard output&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;SYNOPSIS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       base64 [OPTION]... [FILE]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DESCRIPTION&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       Base64 encode or decode FILE, or standard input, to standard output.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -d, --decode&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              decode data&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -i, --ignore-garbage&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              when decoding, ignore non-alphabet characters&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -w, --wrap=COLS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              wrap encoded lines after COLS character (default 76).  Use 0  to&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              disable line wrapping&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       With no FILE, or when FILE is -, read standard input.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       The  data are encoded as described for the base64 alphabet in RFC 3548.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       When decoding, the input may contain newlines in addition to the  bytes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       of  the  formal  base64  alphabet.   Use --ignore-garbage to attempt to&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       recover from any other non-alphabet bytes in the encoded stream.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;用法示例:&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#创建文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brianyang@brianyang-Latitude-E5440:~$ echo &amp;apos;hello world&amp;apos; &amp;gt; /tmp/base64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#base64加密&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brianyang@brianyang-Latitude-E5440:~$ base64 /tmp/base64 &amp;gt; /tmp/base64ed&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brianyang@brianyang-Latitude-E5440:~$ cat /tmp/base64ed &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;aGVsbG8gd29ybGQK&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#base64解密&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brianyang@brianyang-Latitude-E5440:~$ echo aGVsbG8gd29ybGQK|base64 -d&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hello world&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#或&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brianyang@brianyang-Latitude-E5440:~$ base64 -d /tmp/base64ed &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hello world&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#直接输入base64,随后shell进入输入模式，输入一段文字，ctrl+d结束输入，这段文字就会被base64加密.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brianyang@brianyang-Latitude-E5440:~$ base64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hello world&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;aGVsbG8gd29ybGQK&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;&lt;p&gt;Base64是一种基于64个可打印字符来表示二进制数据的表示方法。由于2的6次方等于64，所以每6个比特为一个单元，对应某个可打印字符。三个字节有24个比特，对应于4个Base64单元，即3个字节需要用4个可打印字符来表示。它可用来作为电子邮件的传输编码。在Base64中的可打印字符包括字母A-Z、a-z、数字0-9，这样共有62个字符，此外两个可打印符号在不同的系统中而不同。(摘自:维基百科)&lt;br&gt;Base64常用于在通常处理文本数据的场合，表示、传输、存储一些二进制数据。包括MIME的email、在XML中存储复杂数据。&lt;/p&gt;&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://trytofix.com/categories/Linux/"/>
    
    
      <category term="Linux Command" scheme="http://trytofix.com/tags/Linux-Command/"/>
    
  </entry>
  
  <entry>
    <title>python re模块 findall search match一览</title>
    <link href="http://trytofix.com/2016/03/30/python-re-findall-search-match%E4%B8%80%E8%A7%88/"/>
    <id>http://trytofix.com/2016/03/30/python-re-findall-search-match一览/</id>
    <published>2016-03-30T08:04:11.000Z</published>
    <updated>2016-04-12T11:01:41.178Z</updated>
    
    <content type="html">&lt;p&gt;python正则常用的三个方法：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;re.findall: 在字符串中找到匹配正则表达式的所有结果，如果匹配，返回类型为list,否则为NoneType.&lt;/li&gt;&lt;li&gt;re.search: 在字符串中找到一个匹配正则表达式的结果，如果匹配，返回类型是_sre.SRE_Match,否则为NoneType.&lt;/li&gt;&lt;li&gt;re.match: 判断字符串是否与正则表达式匹配，如果匹配，返回类型为_sre.SRE_Match,否则为NoneType.&lt;/li&gt;&lt;/ul&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;p&gt;看下面的例子：&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]:&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; re&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;]:s = &lt;span class=&quot;string&quot;&gt;&quot;My cat is a dog. My dog is a cat&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]:pattern = re.compile(&lt;span class=&quot;string&quot;&gt;r&quot;\s(is)\s(a)&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;]:g = pattern.findall(s)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;]:type(g)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;]:list&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;]:&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; item &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; g:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; item&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; item[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; item[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;string&quot;&gt;&#39;is&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;string&quot;&gt;&#39;is&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;re.findall返回的是一个list,list的类型是tuple&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;]:g = pattern.search(s)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;]:type(g)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;]:_sre.SRE_Match&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;]:g.groups()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;]:(&lt;span class=&quot;string&quot;&gt;&#39;is&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;]:type(g.groups())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;]:tuple&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;]:g.group()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;]:&lt;span class=&quot;string&quot;&gt;&#39; is a&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;]:g.group(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;]:&lt;span class=&quot;string&quot;&gt;&#39; is a&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;]:type(g.group(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;]:str&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;]:g.group(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;]:&lt;span class=&quot;string&quot;&gt;&#39;is&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;]:g.group(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;]:&lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;re.search返回的是match对象，通过group操作可以获取到匹配的信息：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;g.groups(): 返回tuple格式，内容是所有括号中匹配的字符&lt;/li&gt;&lt;li&gt;g.group(): 所有匹配的字符，与括号无关&lt;/li&gt;&lt;li&gt;g.group(0): 同g.group()&lt;/li&gt;&lt;li&gt;g.group(i): i&amp;gt;0, 第i个括号匹配的字符&lt;/li&gt;&lt;li&gt;g.groups() = (g.group(1), g.group(2), …)&lt;/li&gt;&lt;/ul&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;]:pattern = re.compile( &lt;span class=&quot;string&quot;&gt;&#39;.*?is.*&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;]:g=pattern.match(s)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;]:type(g)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;]:_sre.SRE_Match&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;]:g.groups()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;]:()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;]:g.group()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;]:&lt;span class=&quot;string&quot;&gt;&#39;My cat is a dog. My dog is a cat&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;re.match返回的也是match对象，用法如re.search.&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;python正则常用的三个方法：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;re.findall: 在字符串中找到匹配正则表达式的所有结果，如果匹配，返回类型为list,否则为NoneType.&lt;/li&gt;&lt;li&gt;re.search: 在字符串中找到一个匹配正则表达式的结果，如果匹配，返回类型是_sre.SRE_Match,否则为NoneType.&lt;/li&gt;&lt;li&gt;re.match: 判断字符串是否与正则表达式匹配，如果匹配，返回类型为_sre.SRE_Match,否则为NoneType.&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
      <category term="python" scheme="http://trytofix.com/categories/python/"/>
    
    
      <category term="正则表达式" scheme="http://trytofix.com/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>tar命令使用方法</title>
    <link href="http://trytofix.com/2016/03/30/tar%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    <id>http://trytofix.com/2016/03/30/tar命令使用方法/</id>
    <published>2016-03-30T06:48:52.000Z</published>
    <updated>2016-04-12T11:01:41.174Z</updated>
    
    <content type="html">&lt;p&gt;tar用来打包(提取)或压缩(解压)文件&lt;/p&gt;&lt;p&gt;常用参数&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-c 创建一个存档&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-r 追加文件到存档的末尾&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-t 列出存档的内容&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--delete 从文当中删除&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-u 仅仅更新比存档中文件新的文件到存档中&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-x 从存档中提取文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-f 指定打包到（提取到）的文件名&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-v 显示详细信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-j 使用bzip2压缩存档，生成文件后缀为.tar.bz2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-z 使用gzip压缩存档，生成文件后缀为.tar.gz&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;p&gt;通过例子学习一下：&lt;/p&gt;&lt;p&gt;打包hexo source文件夹到back.tar&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;tar cvf back.tar /home/q/hexo/blog/source/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;查看back.tar中的内容&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;tar -tvf back.tar&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;结果如下：&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;drwxrwxr-x brianyang/brianyang 0 2016-03-24 00:27 home/q/hexo/blog/source/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxrwxr-x brianyang/brianyang 0 2016-03-24 00:27 home/q/hexo/blog/source/about/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 61 2016-03-24 00:27 home/q/hexo/blog/source/about/index.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxrwxr-x brianyang/brianyang  0 2016-03-30 14:55 home/q/hexo/blog/source/_posts/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 5736 2016-03-30 11:12 home/q/hexo/blog/source/_posts/Mime类型列表.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang  893 2016-03-30 11:12 home/q/hexo/blog/source/_posts/jmeter从csv中读取请求参数.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 3025 2016-03-30 11:12 home/q/hexo/blog/source/_posts/spring中使用Jedis.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 2066 2016-03-30 11:12 home/q/hexo/blog/source/_posts/AngularJs-删除表格中的记录并更新视图.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 2954 2016-03-30 14:21 home/q/hexo/blog/source/_posts/chattr和lsattr应用.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 1284 2016-03-30 11:12 home/q/hexo/blog/source/_posts/Flask返回文件.md&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;将test.py文件加入到存档中．&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;tar rvf back.tar test.py&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;再次查看存档中内容&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;tar -tvf back.tar&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxrwxr-x brianyang/brianyang 0 2016-03-24 00:27 home/q/hexo/blog/source/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxrwxr-x brianyang/brianyang 0 2016-03-24 00:27 home/q/hexo/blog/source/about/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 61 2016-03-24 00:27 home/q/hexo/blog/source/about/index.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxrwxr-x brianyang/brianyang  0 2016-03-30 14:55 home/q/hexo/blog/source/_posts/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 5736 2016-03-30 11:12 home/q/hexo/blog/source/_posts/Mime类型列表.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang  893 2016-03-30 11:12 home/q/hexo/blog/source/_posts/jmeter从csv中读取请求参数.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 3025 2016-03-30 11:12 home/q/hexo/blog/source/_posts/spring中使用Jedis.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 2066 2016-03-30 11:12 home/q/hexo/blog/source/_posts/AngularJs-删除表格中的记录并更新视图.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 2954 2016-03-30 14:21 home/q/hexo/blog/source/_posts/chattr和lsattr应用.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 1284 2016-03-30 11:12 home/q/hexo/blog/source/_posts/Flask返回文件.md&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- brianyang/brianyang 195602 2016-03-30 15:01 test.py&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;文件test.py被成功加入到存档中.&lt;/p&gt;&lt;p&gt;将tar包打包为tar.gz包&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;brianyang@brianyang-Latitude-E5440:~$ gzip -kv back.tar &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;back.tar:	 22.0% -- replaced with back.tar.gz&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;gzip用来压缩文件为.gz格式&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-d 解压&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-k 保存原文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-v 显示详细信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-f 覆盖已经存在的输出文件&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;解压back.tar.gz为back.tar&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;gzip -d back.tar.gz&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;bzip2用法与gzip相同，使用bzip2压缩文件，后缀为.bz2&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;brianyang@brianyang-Latitude-E5440:~$ bzip2 -vfk back.tar &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  back.tar:  1.243:1,  6.436 bits/byte, 19.55% saved, 471040 in, 378964 out.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brianyang@brianyang-Latitude-E5440:~$ bzip2 -dvfk back.tar.bz2 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  back.tar.bz2: done&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;使用tar可以直接将文件打包并压缩为tar.gz(-z)或tar.bz2(-j)&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;tar -zcvf back.tar.gz /home/q/hexo/blog/source&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tar -jcvf back.tar.bz2 /home/q/hexo/blog/source&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;tar用来打包(提取)或压缩(解压)文件&lt;/p&gt;&lt;p&gt;常用参数&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-c 创建一个存档&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-r 追加文件到存档的末尾&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-t 列出存档的内容&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--delete 从文当中删除&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-u 仅仅更新比存档中文件新的文件到存档中&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-x 从存档中提取文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-f 指定打包到（提取到）的文件名&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-v 显示详细信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-j 使用bzip2压缩存档，生成文件后缀为.tar.bz2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-z 使用gzip压缩存档，生成文件后缀为.tar.gz&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://trytofix.com/categories/Linux/"/>
    
    
      <category term="Linux Command" scheme="http://trytofix.com/tags/Linux-Command/"/>
    
  </entry>
  
  <entry>
    <title>ng-options设置默认选中值</title>
    <link href="http://trytofix.com/2016/03/30/ng-options%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E9%80%89%E4%B8%AD%E5%80%BC/"/>
    <id>http://trytofix.com/2016/03/30/ng-options设置默认选中值/</id>
    <published>2016-03-30T06:23:42.000Z</published>
    <updated>2016-04-12T11:01:41.170Z</updated>
    
    <content type="html">&lt;p&gt;使用ng-options可以方便的与&lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt;标签结合，生成选项框，与ng-repeat不同的是，当绑定selected对象到ng-model时，ng-options返回的是对象，而ng-repeat返回的是字符串.&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;例子如下:&lt;/p&gt;&lt;p&gt;js代码&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$scope.selects = [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;name&#39;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&#39;wrapperid&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;url&#39;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&#39;/api?wrapperid=&#39;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;name&#39;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&#39;wrappername&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;url&#39;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&#39;/api?wrappername=&#39;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;name&#39;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&#39;supplier_id&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;url&#39;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&#39;/api?supplier_id=&#39;&lt;/span&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $scope.selectedName = $scope.selects[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $scope.querywrapperinfo = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;selected, data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            $http.get(selected.url+data).success(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;response&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(response.ret)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    $scope.wrapperinfos = response.data&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    alert(response.data)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;html代码&lt;/p&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;form-inline&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;ng-model&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;selectedName&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;ng-options&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;x.name for x in selects&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;form-control&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;select&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;ng-model&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;query_value&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;btn btn-default&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;button&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;ng-click&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;querywrapperinfo(selectedName,query_value)&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	   &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;btn btn-default form-control&#39;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;query&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;效果如图&lt;br&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/b8b708a7gw1f2lov01m4yj209401xdfp&quot; alt=&quot;angular-option&quot;&gt;&lt;br&gt;在这里绑定了selectedName到ng-model,并传给了querywrapperinfo这个函数，在这个函数中，通过selected.url可以获取到对应的信息，这说明，selectedName是一个对象，而不是一个string,这也正是ng-options相比于ng-repeat的优势．&lt;/p&gt;&lt;p&gt;&lt;code&gt;$scope.selectedName = $scope.selects[0]&lt;/code&gt;这句就是本章的重点，为ng-options设置一个默认值,这里默认设为了selects中的第一项的值.&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;使用ng-options可以方便的与&lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt;标签结合，生成选项框，与ng-repeat不同的是，当绑定selected对象到ng-model时，ng-options返回的是对象，而ng-repeat返回的是字符串.&lt;br&gt;
    
    </summary>
    
      <category term="AngularJs" scheme="http://trytofix.com/categories/AngularJs/"/>
    
    
      <category term="前端积累" scheme="http://trytofix.com/tags/%E5%89%8D%E7%AB%AF%E7%A7%AF%E7%B4%AF/"/>
    
  </entry>
  
  <entry>
    <title>chattr和lsattr应用</title>
    <link href="http://trytofix.com/2016/03/30/chattr%E5%92%8Clsattr%E5%BA%94%E7%94%A8/"/>
    <id>http://trytofix.com/2016/03/30/chattr和lsattr应用/</id>
    <published>2016-03-30T05:51:43.000Z</published>
    <updated>2016-04-12T11:01:41.170Z</updated>
    
    <content type="html">&lt;p&gt;在部署应用时，常用的做法是将最新版的工程覆盖旧版工程的文件夹，随后重启服务．在服务器上，有一个定时脚本，每个小时生成一份数据放在工程文件夹中，供web访问，当发布工程时，生成的数据文件就会被删除掉,用户访问时，就无法获取到数据文件，直到下次脚本运行，才可以生成数据．为了解决类似的问题，我们需要修改文件的属性，避免文件被删除．在Linux中，这个命令就是chattr,对应的查看文件属性的命令为lsattr.&lt;/p&gt;&lt;p&gt;chattr与chmod命令相比，chmod只能修改文件的读写，执行权限．更底层的属性控制由chattr完成．&lt;/p&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;chattr - change file attributes on a Linux file system&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;基本用法&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;chattr [ -RVf ] [ -v version ] [ mode ] files...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;其中的mode指&lt;code&gt;+-=[acdeijstuACDST]&lt;/code&gt;&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-R 递归的修改文件夹中内容的属性&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-V 查看详细的输出信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-f 忽略大部分的错误信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mode:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ ：在原有参数设定基础上，追加参数。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- ：在原有参数设定基础上，移除参数。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;= ：更新为指定参数设定。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;部分：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;A：文件或目录的 atime (access time)不可被修改(modified)。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a：即append，设定该参数后，只能向文件中添加数据，而不能删除，多用于服务器日志文件安全，只有root才能设定这个属性。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c：即compresse，设定文件是否经压缩后再存储。读取时需要经过自动解压操作。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;i：设定文件不能被删除、改名、设定链接关系，同时不能写入或新增内容。i参数对于文件 系统的安全设置有很大帮助。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;示例：&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;应用举例：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1、用chattr命令防止文件被修改：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# chattr +i /etc/default.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;然后用mv /etc/default.conf等命令操作于该文件，都是得到Operation not permitted 的结果。vim编辑该文件时会提示W10: Warning: Changing a readonly file错误。要想修改此文件就要把i属性去掉： chattr -i /etc/default.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2、让某个文件只能往里面追加数据，但不能删除，适用于各种日志文件：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# chattr +a /var/log/messages&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;通过chattr +i file就可以解决文章一开始遇到的脚本生成数据的问题，在脚本中加入以下内容&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;os.system(&lt;span class=&quot;string&quot;&gt;&quot;sudo chattr -i /home/q/www/test/templates/wrapper_op.html&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;os.system(&lt;span class=&quot;string&quot;&gt;&#39;cp /tmp/wrapper_op.html /home/q/www/test/templates/wrapper_op.html&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;os.system(&lt;span class=&quot;string&quot;&gt;&quot;sudo chattr +i /home/q/www/test/templates/wrapper_op.html&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;通过&lt;code&gt;lsattr wrapper_op.html&lt;/code&gt;查看文件的状态：&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;----i--------e- ./wrapper_op.html&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;在脚本生成新的数据之前将数据文件设置为可删除，随后覆盖数据文件，再将数据文件设置为不可删除(chattr +i .),这样就可以避免发布对数据文件产生的影响.&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;在部署应用时，常用的做法是将最新版的工程覆盖旧版工程的文件夹，随后重启服务．在服务器上，有一个定时脚本，每个小时生成一份数据放在工程文件夹中，供web访问，当发布工程时，生成的数据文件就会被删除掉,用户访问时，就无法获取到数据文件，直到下次脚本运行，才可以生成数据．为了解决类似的问题，我们需要修改文件的属性，避免文件被删除．在Linux中，这个命令就是chattr,对应的查看文件属性的命令为lsattr.&lt;/p&gt;&lt;p&gt;chattr与chmod命令相比，chmod只能修改文件的读写，执行权限．更底层的属性控制由chattr完成．&lt;/p&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://trytofix.com/categories/Linux/"/>
    
    
      <category term="Linux Command" scheme="http://trytofix.com/tags/Linux-Command/"/>
    
  </entry>
  
  <entry>
    <title>AngularJs 删除表格中的记录并更新视图</title>
    <link href="http://trytofix.com/2016/03/29/AngularJs-%E5%88%A0%E9%99%A4%E8%A1%A8%E6%A0%BC%E4%B8%AD%E7%9A%84%E8%AE%B0%E5%BD%95%E5%B9%B6%E6%9B%B4%E6%96%B0%E8%A7%86%E5%9B%BE/"/>
    <id>http://trytofix.com/2016/03/29/AngularJs-删除表格中的记录并更新视图/</id>
    <published>2016-03-29T12:05:15.000Z</published>
    <updated>2016-04-12T11:01:41.166Z</updated>
    
    <content type="html">&lt;p&gt;使用MVVM框架在显示表格时，通过对数据模型的操作可以方便的更新表格视图，表格中常见的操作有删除操作，即在每列后有一个删除按钮，点击后，就可以从表格中删除改行，例如下图所示：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/b8b708a7gw1f2louzx1dtj210b0b0jsn&quot; alt=&quot;angular_remove_table_item&quot;&gt;&lt;/p&gt;&lt;p&gt;如果使用原生js,需要先获取到删除行的index,随后再操作DOM,非常繁琐，使用AngularJs一行代码就可以搞定．注意下面js代码中传入的wrapperalert本身就是一个AngularJs的数据模型．&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;js代码(节选)：&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; myApp = angular.module(&lt;span class=&quot;string&quot;&gt;&#39;myApp&#39;&lt;/span&gt;, []);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    myApp.controller(&lt;span class=&quot;string&quot;&gt;&quot;MyController&quot;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;$scope, $http&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $http.get(&lt;span class=&quot;string&quot;&gt;&quot;/routecheck/wrapper_alert_all/&quot;&lt;/span&gt;).success(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;response&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $scope.wrapperalerts = response&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $scope.del_wrapper_alert= &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;wrapperalert&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        result = confirm(&lt;span class=&quot;string&quot;&gt;&quot;确定要删除么?&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(result)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            $http.get(&lt;span class=&quot;string&quot;&gt;&#39;/routecheck/wrapper_alert/&#39;&lt;/span&gt;+wrapperalert.id+&lt;span class=&quot;string&quot;&gt;&#39;/delete&#39;&lt;/span&gt;).success(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;response&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                alert(response)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                $scope.wrapperalerts.splice($scope.wrapperalerts.indexOf(wrapperalert),&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;html代码(节选):&lt;br&gt;&lt;/p&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;container-fluid&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;ng-app&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;myApp&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;ng-controller&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;MyController&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;table table-striped&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;ng-repeat&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;wrapperalert in wrapperalerts | filter:filter_value&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;[[wrapperalert.wrapperid]]&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;[[wrapperalert.wrappername]]&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;[[wrapperalert.supplier_id]]&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;[[wrapperalert.alert_type]]&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;[[wrapperalert.score]]&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;[[wrapperalert.create_time]]&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;button&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;删除&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;ng-click&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;del_wrapper_alert(wrapperalert)&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;ng-if&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;wrapperalert.id&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                       &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;btn btn-default&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;td&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;tr&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;table&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;使用MVVM框架在显示表格时，通过对数据模型的操作可以方便的更新表格视图，表格中常见的操作有删除操作，即在每列后有一个删除按钮，点击后，就可以从表格中删除改行，例如下图所示：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/b8b708a7gw1f2louzx1dtj210b0b0jsn&quot; alt=&quot;angular_remove_table_item&quot;&gt;&lt;/p&gt;&lt;p&gt;如果使用原生js,需要先获取到删除行的index,随后再操作DOM,非常繁琐，使用AngularJs一行代码就可以搞定．注意下面js代码中传入的wrapperalert本身就是一个AngularJs的数据模型．&lt;br&gt;
    
    </summary>
    
      <category term="AngularJs" scheme="http://trytofix.com/categories/AngularJs/"/>
    
    
      <category term="前端积累" scheme="http://trytofix.com/tags/%E5%89%8D%E7%AB%AF%E7%A7%AF%E7%B4%AF/"/>
    
  </entry>
  
  <entry>
    <title>Postgresql Alter操作</title>
    <link href="http://trytofix.com/2016/03/29/Postgresql-Alter%E6%93%8D%E4%BD%9C/"/>
    <id>http://trytofix.com/2016/03/29/Postgresql-Alter操作/</id>
    <published>2016-03-29T11:36:18.000Z</published>
    <updated>2016-04-12T11:01:41.174Z</updated>
    
    <content type="html">&lt;h1 id=&quot;创建测试表pg-test&quot;&gt;&lt;a href=&quot;#创建测试表pg-test&quot; class=&quot;headerlink&quot; title=&quot;创建测试表pg_test&quot;&gt;&lt;/a&gt;创建测试表pg_test&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# &lt;span class=&quot;keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; pg_test(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;serial&lt;/span&gt; primary &lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&quot;查看表结构&quot;&gt;&lt;a href=&quot;#查看表结构&quot; class=&quot;headerlink&quot; title=&quot;查看表结构&quot;&gt;&lt;/a&gt;查看表结构&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# \d pg_test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            资料表 &quot;public.pg_test&quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 栏位 |          型别          |                    修饰词                     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;------+------------------------+-----------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; id   | integer                | 非空 缺省 nextval(&#39;pg_test_id_seq&#39;::regclass)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; name | character varying(100) | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;索引：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;pg_test_pkey&quot; PRIMARY KEY, btree (id)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;h1 id=&quot;添加一列sex&quot;&gt;&lt;a href=&quot;#添加一列sex&quot; class=&quot;headerlink&quot; title=&quot;添加一列sex&quot;&gt;&lt;/a&gt;添加一列sex&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; pg_test &lt;span class=&quot;keyword&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;column&lt;/span&gt; sex &lt;span class=&quot;built_in&quot;&gt;boolean&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vacation=# \d pg_test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            资料表 &lt;span class=&quot;string&quot;&gt;&quot;public.pg_test&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 栏位 |          型别          |                    修饰词                     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;------+------------------------+-----------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;   | &lt;span class=&quot;built_in&quot;&gt;integer&lt;/span&gt;                | 非空 缺省 &lt;span class=&quot;keyword&quot;&gt;nextval&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;pg_test_id_seq&#39;&lt;/span&gt;::regclass)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;name&lt;/span&gt; | &lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;) | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; sex  | &lt;span class=&quot;built_in&quot;&gt;boolean&lt;/span&gt;                | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;索引：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;pg_test_pkey&quot;&lt;/span&gt; PRIMARY &lt;span class=&quot;keyword&quot;&gt;KEY&lt;/span&gt;, btree (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&quot;删除sex列&quot;&gt;&lt;a href=&quot;#删除sex列&quot; class=&quot;headerlink&quot; title=&quot;删除sex列&quot;&gt;&lt;/a&gt;删除sex列&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; pg_test &lt;span class=&quot;keyword&quot;&gt;drop&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;column&lt;/span&gt; sex;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vacation=# \d&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vacation=# \d pg_test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            资料表 &lt;span class=&quot;string&quot;&gt;&quot;public.pg_test&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 栏位 |          型别          |                    修饰词                     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;------+------------------------+-----------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;   | &lt;span class=&quot;built_in&quot;&gt;integer&lt;/span&gt;                | 非空 缺省 &lt;span class=&quot;keyword&quot;&gt;nextval&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;pg_test_id_seq&#39;&lt;/span&gt;::regclass)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;name&lt;/span&gt; | &lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;) | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;索引：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;pg_test_pkey&quot;&lt;/span&gt; PRIMARY &lt;span class=&quot;keyword&quot;&gt;KEY&lt;/span&gt;, btree (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&quot;修改name类型为varchar-128&quot;&gt;&lt;a href=&quot;#修改name类型为varchar-128&quot; class=&quot;headerlink&quot; title=&quot;修改name类型为varchar(128)&quot;&gt;&lt;/a&gt;修改name类型为varchar(128)&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; pg_test &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vacation=# \d pg_test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            资料表 &lt;span class=&quot;string&quot;&gt;&quot;public.pg_test&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 栏位 |          型别          |                    修饰词                     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;------+------------------------+-----------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;   | &lt;span class=&quot;built_in&quot;&gt;integer&lt;/span&gt;                | 非空 缺省 &lt;span class=&quot;keyword&quot;&gt;nextval&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;pg_test_id_seq&#39;&lt;/span&gt;::regclass)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;name&lt;/span&gt; | &lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;) | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;索引：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;pg_test_pkey&quot;&lt;/span&gt; PRIMARY &lt;span class=&quot;keyword&quot;&gt;KEY&lt;/span&gt;, btree (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&quot;对表重命名，将pg-test命名为pg-test1&quot;&gt;&lt;a href=&quot;#对表重命名，将pg-test命名为pg-test1&quot; class=&quot;headerlink&quot; title=&quot;对表重命名，将pg_test命名为pg_test1&quot;&gt;&lt;/a&gt;对表重命名，将pg_test命名为pg_test1&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# &lt;span class=&quot;keyword&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt; pg_test &lt;span class=&quot;keyword&quot;&gt;RENAME&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TO&lt;/span&gt; pg_test1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vacation=# \d pg_test1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                           资料表 &lt;span class=&quot;string&quot;&gt;&quot;public.pg_test1&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 栏位 |          型别          |                    修饰词                     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;------+------------------------+-----------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;   | &lt;span class=&quot;built_in&quot;&gt;integer&lt;/span&gt;                | 非空 缺省 &lt;span class=&quot;keyword&quot;&gt;nextval&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;pg_test_id_seq&#39;&lt;/span&gt;::regclass)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;name&lt;/span&gt; | &lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;) | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;索引：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;pg_test_pkey&quot;&lt;/span&gt; PRIMARY &lt;span class=&quot;keyword&quot;&gt;KEY&lt;/span&gt;, btree (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&quot;对列重命名&quot;&gt;&lt;a href=&quot;#对列重命名&quot; class=&quot;headerlink&quot; title=&quot;对列重命名&quot;&gt;&lt;/a&gt;对列重命名&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; pg_test1 &lt;span class=&quot;keyword&quot;&gt;rename&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; address;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&quot;设置列为非空&quot;&gt;&lt;a href=&quot;#设置列为非空&quot; class=&quot;headerlink&quot; title=&quot;设置列为非空&quot;&gt;&lt;/a&gt;设置列为非空&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; pg_test1 &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; address &lt;span class=&quot;keyword&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&quot;设置列的默认值&quot;&gt;&lt;a href=&quot;#设置列的默认值&quot; class=&quot;headerlink&quot; title=&quot;设置列的默认值　&quot;&gt;&lt;/a&gt;设置列的默认值&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; pg_test1 &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; address &lt;span class=&quot;keyword&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;default&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vacation=# \d pg_test1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             资料表 &lt;span class=&quot;string&quot;&gt;&quot;public.pg_test1&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  栏位   |          型别          |                    修饰词                     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;---------+------------------------+-----------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;      | &lt;span class=&quot;built_in&quot;&gt;integer&lt;/span&gt;                | 非空 缺省 &lt;span class=&quot;keyword&quot;&gt;nextval&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;pg_test_id_seq&#39;&lt;/span&gt;::regclass)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; address | &lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;) | 非空 缺省 &lt;span class=&quot;string&quot;&gt;&#39;default&#39;&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;索引：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;pg_test_pkey&quot;&lt;/span&gt; PRIMARY &lt;span class=&quot;keyword&quot;&gt;KEY&lt;/span&gt;, btree (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&quot;删除掉列为非空&quot;&gt;&lt;a href=&quot;#删除掉列为非空&quot; class=&quot;headerlink&quot; title=&quot;删除掉列为非空&quot;&gt;&lt;/a&gt;删除掉列为非空&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; pg_test1 &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;column&lt;/span&gt; address &lt;span class=&quot;keyword&quot;&gt;drop&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vacation=# \d pg_test1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             资料表 &lt;span class=&quot;string&quot;&gt;&quot;public.pg_test1&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  栏位   |          型别          |                    修饰词                     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;---------+------------------------+-----------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;      | &lt;span class=&quot;built_in&quot;&gt;integer&lt;/span&gt;                | 非空 缺省 &lt;span class=&quot;keyword&quot;&gt;nextval&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;pg_test_id_seq&#39;&lt;/span&gt;::regclass)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; address | &lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;) | 缺省 &lt;span class=&quot;string&quot;&gt;&#39;default&#39;&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;索引：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;pg_test_pkey&quot;&lt;/span&gt; PRIMARY &lt;span class=&quot;keyword&quot;&gt;KEY&lt;/span&gt;, btree (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&quot;删除掉列的默认值&quot;&gt;&lt;a href=&quot;#删除掉列的默认值&quot; class=&quot;headerlink&quot; title=&quot;删除掉列的默认值&quot;&gt;&lt;/a&gt;删除掉列的默认值&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; pg_test1 &lt;span class=&quot;keyword&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;column&lt;/span&gt; address &lt;span class=&quot;keyword&quot;&gt;drop&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vacation=# \d pg_test1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             资料表 &lt;span class=&quot;string&quot;&gt;&quot;public.pg_test1&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  栏位   |          型别          |                    修饰词                     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;---------+------------------------+-----------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;      | &lt;span class=&quot;built_in&quot;&gt;integer&lt;/span&gt;                | 非空 缺省 &lt;span class=&quot;keyword&quot;&gt;nextval&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;pg_test_id_seq&#39;&lt;/span&gt;::regclass)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; address | &lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;) | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;索引：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;pg_test_pkey&quot;&lt;/span&gt; PRIMARY &lt;span class=&quot;keyword&quot;&gt;KEY&lt;/span&gt;, btree (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;创建测试表pg-test&quot;&gt;&lt;a href=&quot;#创建测试表pg-test&quot; class=&quot;headerlink&quot; title=&quot;创建测试表pg_test&quot;&gt;&lt;/a&gt;创建测试表pg_test&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# &lt;span class=&quot;keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; pg_test(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;serial&lt;/span&gt; primary &lt;span class=&quot;keyword&quot;&gt;key&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&quot;查看表结构&quot;&gt;&lt;a href=&quot;#查看表结构&quot; class=&quot;headerlink&quot; title=&quot;查看表结构&quot;&gt;&lt;/a&gt;查看表结构&lt;/h1&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vacation=# \d pg_test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            资料表 &quot;public.pg_test&quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 栏位 |          型别          |                    修饰词                     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;------+------------------------+-----------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; id   | integer                | 非空 缺省 nextval(&#39;pg_test_id_seq&#39;::regclass)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; name | character varying(100) | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;索引：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;pg_test_pkey&quot; PRIMARY KEY, btree (id)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://trytofix.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="Postgresql" scheme="http://trytofix.com/tags/Postgresql/"/>
    
      <category term="DDL" scheme="http://trytofix.com/tags/DDL/"/>
    
  </entry>
  
  <entry>
    <title>Flask返回文件</title>
    <link href="http://trytofix.com/2016/03/24/Flask%E8%BF%94%E5%9B%9E%E6%96%87%E4%BB%B6/"/>
    <id>http://trytofix.com/2016/03/24/Flask返回文件/</id>
    <published>2016-03-24T06:29:04.000Z</published>
    <updated>2016-04-12T11:01:41.170Z</updated>
    
    <content type="html">&lt;p&gt;Flask响应请求有以下几种方法：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;render_template 返回模板文件&lt;/li&gt;&lt;li&gt;jsonify 返回json格式的数据&lt;/li&gt;&lt;li&gt;Response 自定义返回的数据及类型&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;当服务端需要返回图片或者各种格式的文件时，就需要使用Response进行自定义返回．&lt;/p&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;p&gt;例如当用户请求服务器并传递图片id时,返回给用户的是一张图片，就需要使用Response返回数据，示例如下：&lt;/p&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# encoding:utf8&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;__author__ = &lt;span class=&quot;string&quot;&gt;&#39;brianyang&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; flask &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Response, Flask&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app = Flask(__name__)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@app.route(&quot;/image/&amp;lt;imageid&amp;gt;&quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(imageid)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    image = file(&lt;span class=&quot;string&quot;&gt;&quot;丽江/&amp;#123;&amp;#125;.jpg&quot;&lt;/span&gt;.format(imageid))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    resp = Response(image, mimetype=&lt;span class=&quot;string&quot;&gt;&quot;image/jpeg&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; resp&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.run(debug=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;启动服务，当用户访问&lt;a href=&quot;http://127.0.0.1:5000/image/1&quot; rel=&quot;external nofollow&quot; target=&quot;_blank&quot;&gt;http://127.0.0.1:5000/image/1&lt;/a&gt; 时，会返回服务器根目录中/image/1.jpg这张图片．&lt;/p&gt;&lt;p&gt;HTTP响应报文&lt;/p&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Connection:close&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-Type:image/jpeg&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Date:Thu, 24 Mar 2016 06:21:35 GMT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Server:Werkzeug/0.10.4 Python/2.7.8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;返回的类型为image/jpeg&lt;/p&gt;&lt;p&gt;定义mimetype可以支持返回多种类型的文件，请参考&lt;a href=&quot;http://trytofix.github.io/2016/03/23/Mime%E7%B1%BB%E5%9E%8B%E5%88%97%E8%A1%A8/&quot; rel=&quot;external nofollow&quot; target=&quot;_blank&quot;&gt;MIME类型列表&lt;/a&gt;．&lt;/p&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;Flask响应请求有以下几种方法：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;render_template 返回模板文件&lt;/li&gt;&lt;li&gt;jsonify 返回json格式的数据&lt;/li&gt;&lt;li&gt;Response 自定义返回的数据及类型&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;当服务端需要返回图片或者各种格式的文件时，就需要使用Response进行自定义返回．&lt;/p&gt;
    
    </summary>
    
      <category term="python" scheme="http://trytofix.com/categories/python/"/>
    
    
      <category term="Flask" scheme="http://trytofix.com/tags/Flask/"/>
    
  </entry>
  
</feed>
